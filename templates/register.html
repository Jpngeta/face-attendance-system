{% extends "base.html" %}
{% block title %}Register Student{% endblock %}
{% block content %}
<h1><i class="bi bi-person-plus"></i> Register New Student</h1>
<div class="card mt-4">
    <div class="card-body">
        <form id="registerForm">
            <div class="mb-3">
                <label class="form-label">Student ID *</label>
                <input type="text" class="form-control" id="studentId" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Name *</label>
                <input type="text" class="form-control" id="studentName" required>
            </div>
            <div class="mb-3">
                <label class="form-label">Email</label>
                <input type="email" class="form-control" id="email">
            </div>
            <div class="mb-3">
                <label class="form-label">Phone</label>
                <input type="tel" class="form-control" id="phone">
            </div>
            <div class="mb-3">
                <label class="form-label">Program</label>
                <input type="text" class="form-control" id="program">
            </div>
            <button type="submit" class="btn btn-primary">Register</button>
        </form>
        <div id="message" class="mt-3"></div>
    </div>
</div>
{% endblock %}
{% block extra_js %}
<script>
document.getElementById('registerForm').onsubmit = function(e) {
    e.preventDefault();
    const data = {
        student_id: document.getElementById('studentId').value,
        name: document.getElementById('studentName').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        program: document.getElementById('program').value
    };
    fetch('/api/students', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify(data)
    })
    .then(r => r.json())
    .then(result => {
        const msg = document.getElementById('message');
        if (result.success) {
            msg.innerHTML = '<div class="alert alert-success">Student registered! Now capture face images using insightface_capture.py</div>';
            document.getElementById('registerForm').reset();
        } else {
            msg.innerHTML = '<div class="alert alert-danger">Error: ' + result.error + '</div>';
        }
    });
};
</script>
{% endblock %}
